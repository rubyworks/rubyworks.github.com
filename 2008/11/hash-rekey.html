
<html>

<head>
  <title>Ruby Works</title>

  <link REL="SHORTCUT ICON" HREF="../../assets/images/ruby_1.jpg" />

  <style>
    body  { font-family: arial; font-size: 11pt; margin: 0; padding: 0; background: url(../../assets/images/bg.jpg) 0 -10px repeat-x #dfdfff; }

       a  { text-decoration: none; }

       a:hover  { text-decoration: underline; }

     img  { border: none; }

      li  { font-family: monospace; font-size: 10pt; padding-bottom: 30px; }

     .nav { font-family: arial;  height: 365px; border-left: 1px solid #ccc; border-right: 1px solid #ccc; }

     .nav a { font-size: 18px; font-weight: bold; line-height: 36px; padding: 0 6px; text-decoration: none; }

   .links a { color: #aaa; font-size: 0.9em; }

   .title { font-family: arial; color: red; font-size: 28pt; height: 64px; background: url(../../assets/images/ruby_1.jpg) no-repeat; padding-left: 64px; }

   .title a { text-decoration: none; font-family: arial; color: red; font-size: 28pt; height: 64px; }

   .title .date { font-size: 20pt; }

   .footer { font-size: 10px; border-top: 1px solid #ccc; color: #999; }
  </style>
</head>

<body>

<div style="margin: 0 auto; width: 960px;">

<!-- Title -->
<div class="nav" style="background: url(../../assets/images/serpent.jpg) no-repeat; padding-left: 300px;">

  <div style="font-family: arial; font-size: 32pt; color: #ee0022;">
    <br/>
    <b>Ruby Works</b> <br/>
    <a href="../../index.html">Blog.read</a>
    <a href="../../projects.html">Self.inspect</a>
    <a href="../../rubynew.html">Ruby.new</a>
    <a href="http://github.com/rubyworks/">Github.com</a>
  </div>
   
  <div style="margin-top: 40px;">
    <FORM method="GET" action="http://www.google.com/groups" target="_blank">
    <!-- Search Google -->
    <A HREF="http://www.google.com/">
    <IMG SRC="http://www.google.com/logos/Logo_25wht.gif" border="0" ALT="Google" align="absmiddle"></A>
    <INPUT TYPE="text" name="q" size="25" maxlength="255" value="">
    <input type="hidden" name="hl" value="en">
    <input type="hidden" name="group" value="comp.lang.ruby">
    <INPUT type="submit" name="btnG" VALUE="Search Ruby Talk">
    <!-- Search Google -->
    </FORM>
  </div>

</div>

<div style="padding: 20px; background: white;">


<div class="page">

  <div class="title"><a href="">Facets Hash#rekey</a></div>

  <p>This is the first in a series of posts in which I plan to introduce my fellow Rubyists to the plethora or goodness that is <a href="http://facets.rubyforge.org">Ruby Facets</a>.</p>

<p>Ruby Facets has been in development for several years, starting out as a rather rag-tag collection general purpose Ruby scripts, and has evolved into the latest release, version 2.5.0, which has reached a nice level of maturity --getting pretty close, I suppose one could say, to that stately realm of "enterprise-ready".</p>

<p>Every few weeks or so, I'll pick a library or particular extension and expound upon it. While the main intent of this series is to let others know what Facets makes available to them. I will also use it as a platform to further improve and polish Facets. So please, feel free to comment, make suggestions and point out alternatives, so that Facets might better serve the Ruby community in the future.

Okay, now to the meat of this edition...

I decided to start with something quite simple, but very useful, homogenizing hash keys. Currently in Ruby, this requires code like:</p>


<div class="CodeRay">
  <div class="code"><pre>
  new_hash = {}
  old_hash.each <span style="color:#080;font-weight:bold">do</span> |k,v|
    k = k.to_sym
    new_hash[k] = v
  <span style="color:#080;font-weight:bold">end</span>

</pre></div>
</div>

<p>Of course, that can be golfed-down a bit, but I wanted to spell it out for clarity. In this particular example, I converted all the keys to symbols (<code>to_sym</code>). Along with strings, that is one of the most commonly needed key conversions. Common enough in fact that Rails' ActiveSupport library provides <code>symbolize_keys</code> and an alias <code>#to_options</code>. It's also provides <code>stringify_keys</code>. Facets offers these methods too, since they are certainly so well known by now. However, Facets provides and recommends a more versatile method, <code>rekey</code>. With it the above example becomes as simple as:</p>

<div class="CodeRay">
  <div class="code"><pre>
  old_hash.rekey

</pre></div>
</div>

<p><code>Hash#rekey</code> actually takes a block, but if no block is given, as in the above, it defaults to symbol conversion. If we wanted to convert the keys to strings instead, the magic of Symbol#to_proc makes that as simple as:</p>

<div class="CodeRay">
  <div class="code"><pre>
  old_hash.rekey(&amp;<span style="color:#A60">:to_s</span>)

</pre></div>
</div>

<p>And lastly, of course, we could get crazy with it and make every key a "Turk".</p>

<div class="CodeRay">
  <div class="code"><pre>
  old_hash.rekey{ |k| <span style="color:#036;font-weight:bold">Turk</span>.new(k) }

</pre></div>
</div>

<p>I don't know about you, but I like turk-keys. Oh, the pun! It hurts! :)</p>

<p>Happy Thanksgiving.</p>


  <small>Written by trans, 2008-11-23</small>

  <ul class="posts">
    
    
  </ul>

  <script>
  var idcomments_acct = '1e97cd0a25f01bb50181e727255ddffb';
  var idcomments_post_id;
  var idcomments_post_url;
  </script>
  <span id="IDCommentsPostTitle" style="display:none"></span>
  <script type='text/javascript' src='http://www.intensedebate.com/js/genericCommentWrapperV2.js'></script>

</div>



<br/><br/>

<div style="text-align: center;">
  <script type="text/javascript"><!--
  google_ad_client = "pub-1126154564663472";
  /* RUBYWORKS 09-10-02 728x90 */
  google_ad_slot = "0788888658";
  google_ad_width = 728;
  google_ad_height = 90;
  //-->
  </script>
  <script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div>

<br/><br/>

<div class="footer">
(c) 2002 Thomas Sawyer, All Rights Reserved. Special Thanks to Dieter Stein for the Ruby icon.
Graphic image is "Serpent" by Ruby Lee.
</div>

</body>

</div>
</html>

